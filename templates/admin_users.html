{% extends "base.html" %}

{% block title %}Users - Parking Ops{% endblock %}

{% block content %}
<div class="ops-shell">
  {% include "partials/admin_sidebar.html" %}

  <main class="ops-main">
    <header class="page-header">
      <p class="breadcrumb">Operations / Users</p>
      <h1 class="page-title">Registered Users</h1>
      <p class="page-subtitle">Review user accounts and account roles.</p>
    </header>

    <section class="stats-grid">
      <article class="stat-card">
        <div class="stat-label">Total Users</div>
        <div class="stat-value">{{ users | length }}</div>
      </article>
      <article class="stat-card">
        <div class="stat-label">Admins</div>
        <div class="stat-value">{{ users | selectattr('role', 'equalto', 'admin') | list | length }}</div>
      </article>
      <article class="stat-card">
        <div class="stat-label">Regular Users</div>
        <div class="stat-value">{{ users | selectattr('role', 'equalto', 'user') | list | length }}</div>
      </article>
    </section>

    {% if users %}
    <section class="simple-grid two">
      {% for user in users %}
      <article class="card" style="padding: 18px;">
        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 14px; padding-bottom: 12px; border-bottom: 1px solid var(--border);">
          <div style="width: 44px; height: 44px; border-radius: 50%; background: #eef2ff; color: #1e3a8a; display: inline-flex; align-items: center; justify-content: center; font-family: 'Sora', sans-serif; font-weight: 600;">
            {{ user.full_name[0].upper() if user.full_name else user.email[0].upper() }}
          </div>
          <div style="min-width: 0;">
            <div style="font-weight: 600;">{{ user.full_name }}</div>
            <div class="notice" style="overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">{{ user.email }}</div>
          </div>
        </div>

        <div class="info-list">
          <div class="info-row">
            <span class="info-label">User ID</span>
            <span class="info-value">#{{ user.id }}</span>
          </div>
          <div class="info-row">
            <span class="info-label">Role</span>
            <span class="badge {% if user.role == 'admin' %}badge-danger{% else %}badge-success{% endif %}">{{ user.role }}</span>
          </div>
          <div class="info-row">
            <span class="info-label">Address</span>
            <span class="info-value">{{ user.address }}</span>
          </div>
          <div class="info-row">
            <span class="info-label">PIN Code</span>
            <span class="info-value">{{ user.pincode }}</span>
          </div>
        </div>
      </article>
      {% endfor %}
    </section>
    {% else %}
    <div class="card empty-state">
      <h2>No users found</h2>
      <p>No registered users are available yet.</p>
    </div>
    {% endif %}
  </main>
</div>
{% endblock %}
